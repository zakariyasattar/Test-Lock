window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},window.cancelRequestAnimFrame=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;var init,paddleHit,canvas=document.getElementById("pong-canvas"),ctx=canvas.getContext("2d"),W=window.innerWidth,H=window.innerHeight-55,particles=[],ball={},paddles=[3],mouse={},points=0,fps=60,particlesCount=20,flag=0,particlePos={},multipler=1,startBtn={},restartBtn={},over=0,students=[],isPaused=!1,mc=new Hammer(canvas);function paintCanvas(){ctx.fillStyle="black",ctx.fillRect(0,0,W,H)}function Paddle(e){this.h=5,this.w=150,this.x=W/2-this.w/2,this.y="top"==e?0:H-this.h}function createParticles(e,t,a){this.x=e||0,this.y=t||0,this.radius=1.2,this.vx=3*Math.random()-1.5,this.vy=a*Math.random()*1.5}function draw(){paintCanvas();for(var e=0;e<paddles.length;e++)p=paddles[e],ctx.fillStyle="white",ctx.fillRect(p.x,p.y,p.w,p.h);ball.draw(),update()}function increaseSpd(){points%4==0&&Math.abs(ball.vx)<15&&(ball.vx+=ball.vx<0?-1:1,ball.vy+=ball.vy<0?-2:2)}function trackPosition(e){mouse.x=e.pageX,mouse.y=e.pageY}function update(){if(updateScore(),ctx.fillStlye="white",ctx.font="16px Arial, sans-serif",ctx.textAlign="right",ctx.textBaseline="top",ctx.fillText("Press 'space' to pause ",window.innerWidth-20,20),!window.matchMedia("only screen and (max-width: 760px)").matches&&mouse.x&&mouse.y)for(var e=1;e<paddles.length;e++)p=paddles[e],p.x=mouse.x-p.w/2;if(ball.x+=ball.vx,ball.y+=ball.vy,p1=paddles[1],p2=paddles[2],collides(ball,p1)?collideAction(ball,p1):collides(ball,p2)?collideAction(ball,p2):(ball.y+ball.r>H?(ball.y=H-ball.r,gameOver()):ball.y<0&&(ball.y=ball.r,gameOver()),ball.x+ball.r>W?(ball.vx=-ball.vx,ball.x=W-ball.r):ball.x-ball.r<0&&(ball.vx=-ball.vx,ball.x=ball.r)),1==flag)for(var t=0;t<particlesCount;t++)particles.push(new createParticles(particlePos.x,particlePos.y,multiplier));emitParticles(),flag=0}function collides(e,t){if(e.x+ball.r>=t.x&&e.x-ball.r<=t.x+t.w)return e.y>=t.y-t.h&&t.y>0?(paddleHit=1,!0):e.y<=t.h&&0==t.y&&(paddleHit=2,!0)}function collideAction(e,t){e.vy=-e.vy,1==paddleHit?(e.y=t.y-t.h,particlePos.y=e.y+e.r,multiplier=-1):2==paddleHit&&(e.y=t.h+e.r,particlePos.y=e.y-e.r,multiplier=1),points++,increaseSpd(),particlePos.x=e.x,flag=1}function emitParticles(){for(var e=0;e<particles.length;e++)par=particles[e],ctx.beginPath(),ctx.fillStyle="white",par.radius>0&&ctx.arc(par.x,par.y,par.radius,0,2*Math.PI,!1),ctx.fill(),par.x+=par.vx,par.y+=par.vy,par.radius=Math.max(par.radius-.05,0)}function updateScore(){ctx.fillStlye="white",ctx.font="16px Arial, sans-serif",ctx.textAlign="left",ctx.textBaseline="top",ctx.fillText("Score: "+points,20,20)}function gameOver(){if(ctx.fillStlye="white",ctx.font="20px Arial, sans-serif",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Game Over - You scored "+points+" points!",W/2,H/2+25),points>5){var e=prompt("Would you like to report your score? Input id below! (Double tap space bar to reopen if closed)");e&&submitToLeaderboard(e)}cancelRequestAnimFrame(init),over=1,restartBtn.draw()}function submitToLeaderboard(e){var t=[];(firebase.database().ref("leaderboard").push("Student;"+getStudent(e).split(";")[1]+";"+points),-1!=getStudent(e))?(firebase.database().ref("leaderboard").on("value",(function(a){a.forEach((function(a){getStudent(e).split(";")[1]==a.val().split(";")[0]&&t.push(a.val()+";"+a.key)}));for(var n=-111111111,l=0;l<t.length;l++)t[l].split(";")[1]>n&&(n=t[l].split(";")[1]);for(l=0;l<t.length;l++)t[l].split(";")[1]!=n&&firebase.database().ref("leaderboard").child(t[l].split(";")[2]).remove()})),populateLeaderboard()):(swal("Error!","hmmm, real ID?","error"),(e=prompt("Would you like to report your score? Input id below! (Double tap space bar to reopen if closed)"))&&submitToLeaderboard(e))}function populateLeaderboard(){jQuery(".tr").remove(),jQuery(".br").remove();var e=[],t=document.getElementById("table");document.getElementById("pong").style.display="none",document.getElementById("leaderboard").style.display="initial",document.getElementById("main").style.display="none",firebase.database().ref("leaderboard").once("value",(function(t){t.forEach((function(t){e.push(t.val())}))})),setTimeout((function(){for(var a=(e=leaderboardSort(e)).length-1;a>=0;a--){var n=document.createElement("tr");n.className="tr";var l,i=document.createElement("td"),r=document.createElement("td"),s=document.createElement("td"),o=document.createElement("td");if(i.innerHTML=e.length-a,i.style.paddingLeft="20px",r.innerHTML=e[a].split(";")[1],r.className="name",r.style.paddingLeft="10px",s.innerHTML=e[a].split(";")[2],s.style.paddingLeft="10px",o.innerHTML=e[a].split(";")[0],o.style.paddingLeft="10px",a==e.length-1)(l=document.createElement("br")).className="br",t.appendChild(l);n.appendChild(i),n.appendChild(r),n.appendChild(s),n.appendChild(o),t.appendChild(n),(l=document.createElement("br")).className="br",t.appendChild(l)}}),150)}function leaderboardSort(e){if(1==e.length)return e;const t=Math.floor(e.length/2),a=e.slice(0,t),n=e.slice(t);return leaderboardMerge(leaderboardSort(a),leaderboardSort(n))}function leaderboardMerge(e,t){let a=[],n=0,l=0;for(;n<e.length&&l<t.length;)parseInt(e[n].split(";")[1])<parseInt(t[l].split(";")[1])?(a.push(e[n]),n++):(a.push(t[l]),l++);return a.concat(e.slice(n)).concat(t.slice(l))}function getStudent(e){for(var t,a=0,n=(students=studentMerge(students)).length-1;a<=n;){if(t=Math.floor((a+n)/2),students[t].split(";")[0]==e)return students[t];students[t].split(";")[0]<e?a=t+1:n=t-1}return-1}function studentMerge(e){if(1===e.length)return e;const t=Math.floor(e.length/2),a=e.slice(0,t),n=e.slice(t);return mergeStudents(studentMerge(a),studentMerge(n))}function mergeStudents(e,t){let a=[],n=0,l=0;for(;n<e.length&&l<t.length;)e[n].split(";")[0]<t[l].split(";")[0]?(a.push(e[n]),n++):(a.push(t[l]),l++);return a.concat(e.slice(n)).concat(t.slice(l))}function animloop(){init=requestAnimFrame(animloop),draw()}function startScreen(){draw(),startBtn.draw()}function btnClick(e){var t=e.pageX;e.pageY;t>=startBtn.x&&t<=startBtn.x+startBtn.w&&(animloop(),startBtn={}),1==over&&t>=restartBtn.x&&t<=restartBtn.x+restartBtn.w&&(ball.x=20,ball.y=20,points=0,ball.vx=4,ball.vy=8,animloop(),over=0)}document.body.onkeyup=function(e){32==e.keyCode&&(isPaused?(animloop(),isPaused=!1):(cancelRequestAnimFrame(init),isPaused=!0))},firebase.database().ref("Students").on("value",(function(e){e.forEach((function(e){students.push(e.val())}))})),canvas.addEventListener("mousemove",trackPosition,!0),canvas.addEventListener("mousedown",btnClick,!0),canvas.width=W,canvas.height=H,paddles.push(new Paddle("bottom")),paddles.push(new Paddle("top")),ball={x:50,y:50,r:5,c:"white",vx:4,vy:8,draw:function(){ctx.beginPath(),ctx.fillStyle=this.c,ctx.arc(this.x,this.y,this.r,0,2*Math.PI,!1),ctx.fill()}},startBtn={w:100,h:50,x:W/2-50,y:H/2-25,draw:function(){ctx.strokeStyle="white",ctx.lineWidth="2",ctx.strokeRect(this.x,this.y,this.w,this.h),ctx.font="18px Arial, sans-serif",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStlye="white",ctx.fillText("Start",W/2,H/2)}},restartBtn={w:100,h:50,x:W/2-50,y:H/2-50,draw:function(){ctx.strokeStyle="white",ctx.lineWidth="2",ctx.strokeRect(this.x,this.y,this.w,this.h),ctx.font="18px Arial, sans-serif",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillStlye="white",ctx.fillText("Restart",W/2,H/2-25)}},mc.on("pan",(function(e){for(var t=1;t<paddles.length;t++)p=paddles[t],p.x=e.center.x-p.w})),startScreen();
//# sourceMappingURL=index.9eb0f825.js.map
